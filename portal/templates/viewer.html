{% extends 'portal.html' %}

{% block content %}
<div class="row mb-3">
    <div class="col-2">
        <h2><i class="fas fa-angle-double-right text-primary text-primary"></i>&nbsp;&nbsp;Reading</h2>        
    </div>
    <div class="col-10">
        <ul class="nav nav-pills justify-content-end" id="ex1" role="tablist">
            <li class="nav-item" role="presentation">
              <a
                class="nav-link active"
                id="ex1-tab-1"
                data-mdb-toggle="pill"
                href="#ex1-pills-1"
                role="tab"
                aria-controls="ex1-pills-1"
                aria-selected="true"
                >Patient A</a
              >
            </li>
            <li class="nav-item" role="presentation">
              <a
                class="nav-link"
                id="ex1-tab-2"
                data-mdb-toggle="pill"
                href="#ex1-pills-2"
                role="tab"
                aria-controls="ex1-pills-2"
                aria-selected="false"
                >Patient B</a
              >
            </li>
            <li class="nav-item" role="presentation">
              <a
                class="nav-link"
                id="ex1-tab-3"
                data-mdb-toggle="pill"
                href="#ex1-pills-3"
                role="tab"
                aria-controls="ex1-pills-3"
                aria-selected="false"
                >Patient C</a
              >
            </li>
          </ul>
          <!-- Pills navs -->
    </div>
</div>



<form method="post"  hx-post="/wado/populate-instances"
_="
def swap(attr1, attr2)
    add .{attr1}
    remove .{attr2}
end
on htmx:afterRequest 
    if detail.successful then 
      call location.reload()
    else put 'Error!' into me
        swap('btn-danger','btn-primary')
        call Swal.fire({title: 'Error', text:detail.xhr.responseText})"
>{% csrf_token %}
  <button class='btn btn-primary mb-3'>Populate</button>
</form>

<div class="w-25">
<div class="form-outline">
  <select class="form-control" style="background-color: rgb(48, 48, 48);" name="series" id="series" value="" onchange="pickSeries(event)">
    <option value="">Select...</option>
    {% for i in series %}
        <option value="{{i.0}}:::{{i.1}}">{{ i.2 }}</option>
    {% endfor %}
  </select>
  <div class="form-notch"><div class="form-notch-leading" style="width: 9px;"></div><div class="form-notch-middle" style="width: 0px;"></div><div class="form-notch-trailing"></div></div>
</div></div>


<div id="content"></div>
<script defer src="/static/js/viewer.js"></script>
<script type="text/javascript">
function pickSeries(evt) {
    if (evt.target.value == "") { 
        return;
    }
    values = evt.target.value.split(":::")
    studyUID = values[0]
    seriesUID = values[1]
    // console.log(seriesUID, studyUID)
    // console.log('1.3.6.1.4.1.5962.99.1.1647423216.1757746261.1397511827184.6.0', '1.3.6.1.4.1.5962.99.1.1647423216.1757746261.1397511827184.7.0')
    // run('1.3.6.1.4.1.5962.99.1.1647423216.1757746261.1397511827184.6.0', '1.3.6.1.4.1.5962.99.1.1647423216.1757746261.1397511827184.7.0')
    run(studyUID, seriesUID)
}
window.onload = async function() {
    // 
}
</script>
{% endblock %}